{"ast":null,"code":"import React,{useEffect}from'react';import{Button,Row,Col,ListGroup,Image,Card}from\"react-bootstrap\";import{Link}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import CheckoutSteps from\"../components/CheckoutSteps\";import Message from\"../components/Message\";import{createOrder}from\"../actions/orderAction\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaceOrderScreen(_ref){var history=_ref.history;var cart=useSelector(function(state){return state.cart;});// Calculate prices, toFixed is converting number to string\ncart.itemsPrice=cart.cartItems.reduce(function(acc,item){return Number(acc+item.price*item.qty);},0);cart.shippingPrice=cart.itemsPrice<1000?Number((cart.itemsPrice*0.1).toFixed(2)):0;cart.taxPrice=Number((0.05*cart.itemsPrice).toFixed(2));cart.totalPrice=cart.itemsPrice+cart.shippingPrice+cart.taxPrice;var orderCreate=useSelector(function(state){return state.orderCreate;});var order=orderCreate.order,success=orderCreate.success,error=orderCreate.error;useEffect(function(){if(success){console.log(\"success\");history.push(\"order/\".concat(order._id));console.log(\"success\");}},[history,success,order]);// convert cart in Redux to Order in MongoDB\nvar dispatch=useDispatch();var placeOrderHandler=function placeOrderHandler(e){console.log(\"Clicked place the order handler\");dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true,children:\" \"}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Shipping \"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\" Address \"}),cart.shippingAddress.address,\", \",/*#__PURE__*/_jsx(\"br\",{}),cart.shippingAddress.address,\",  \",/*#__PURE__*/_jsx(\"br\",{}),cart.shippingAddress.postalCode,\", \",/*#__PURE__*/_jsx(\"br\",{}),cart.shippingAddress.country,\" \",/*#__PURE__*/_jsx(\"br\",{})]})]}),/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Payment Method \"}),/*#__PURE__*/_jsx(\"strong\",{children:\" Method: \"}),cart.paymentMethod]}),/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Order Items \"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{children:\" Your cart is empty \"}):/*#__PURE__*/_jsx(ListGroup,{children:cart.cartItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true})}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product)}),item.name]}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" x $\",item.price,\" = $\",(item.qty*item.price).toFixed(2)]})]})},index);})})]})]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\" Order Summary \"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Items \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" 10% Shipping Fee (free for items over $1000) \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Tax \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\" Total \"}),/*#__PURE__*/_jsxs(Col,{children:[\" $\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsxs(\"h1\",{variant:\"danger\",children:[\"  \",error,\"  \"]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cart.cartItems===0,onClick:placeOrderHandler,children:\" PlaceOrder \"})})]})})})]})]});}","map":{"version":3,"sources":["/home/jack/Desktop/Software Codebase/20210514 E-Commerce Version1/3d2021store/frontend/src/screens/PlaceOrderScreen.js"],"names":["React","useEffect","Button","Row","Col","ListGroup","Image","Card","Link","useDispatch","useSelector","CheckoutSteps","Message","createOrder","PlaceOrderScreen","history","cart","state","itemsPrice","cartItems","reduce","acc","item","Number","price","qty","shippingPrice","toFixed","taxPrice","totalPrice","orderCreate","order","success","error","console","log","push","_id","dispatch","placeOrderHandler","e","orderItems","shippingAddress","paymentMethod","address","postalCode","country","length","map","index","image","name","product"],"mappings":"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","sourcesContent":["import React , {useEffect} from 'react'\n\n\nimport {Button, Row, Col, ListGroup, Image, Card} from \"react-bootstrap\"\nimport {Link} from \"react-router-dom\"\nimport {useDispatch, useSelector} from \"react-redux\"\n\nimport CheckoutSteps from \"../components/CheckoutSteps\"\nimport Message from \"../components/Message\"\nimport {createOrder} from \"../actions/orderAction\" \n\nexport default function PlaceOrderScreen({history}) {\n    \n    const cart = useSelector(state => state.cart)\n\n    // Calculate prices, toFixed is converting number to string\n    cart.itemsPrice = cart.cartItems.reduce((acc, item) => {return Number(acc + item.price * item.qty)}, 0)\n    cart.shippingPrice = (cart.itemsPrice < 1000 ? Number((cart.itemsPrice * 0.1).toFixed(2)) : 0)\n    cart.taxPrice = Number((0.05 * cart.itemsPrice).toFixed(2))\n    cart.totalPrice = (cart.itemsPrice + cart.shippingPrice + cart.taxPrice)\n\n    const orderCreate = useSelector(state => state.orderCreate)\n    const {order, success, error} = orderCreate\n\n    useEffect(()=>{\n        if (success) {\n            console.log(\"success\")\n            history.push(`order/${order._id}`)\n            console.log(\"success\")\n        }\n    }, [history, success, order])\n\n\n    // convert cart in Redux to Order in MongoDB\n    const dispatch = useDispatch( )\n    const placeOrderHandler = (e) => {\n        console.log(\"Clicked place the order handler\")\n        dispatch(createOrder({\n            orderItems: cart.cartItems,\n            shippingAddress: cart.shippingAddress,\n            paymentMethod: cart.paymentMethod,\n            itemsPrice: cart.itemsPrice,\n            shippingPrice: cart.shippingPrice,\n            taxPrice: cart.taxPrice,\n            totalPrice: cart.totalPrice\n        }))\n        }\n\n\n    return (\n        <div>\n            <CheckoutSteps step1 step2 step3 step4> </CheckoutSteps>\n            <Row>\n                <Col md={8}>\n                    <ListGroup variant=\"flush\">\n                        <h2> Shipping </h2>\n                        <p> \n                            <strong> Address </strong>\n                            {cart.shippingAddress.address}, <br/>\n                            {cart.shippingAddress.address},  <br/>\n                            {cart.shippingAddress.postalCode}, <br/>\n                            {cart.shippingAddress.country} <br/>\n                        </p>\n        \n                    </ListGroup>\n\n                    <ListGroup>\n                        <h2> Payment Method </h2>\n                        <strong> Method: </strong> \n                        {cart.paymentMethod}\n                    </ListGroup>            \n\n                    <ListGroup>\n                        <h2> Order Items </h2>\n                        {cart.cartItems.length === 0 ? <Message> Your cart is empty </Message> : (\n                            <ListGroup> \n                                {cart.cartItems.map((item, index)=>{return (\n                                    <ListGroup.Item key={index}>\n                                        <Row>\n                                            <Col md={1}>\n                                                <Image src={item.image} alt={item.name} fluid />\n                                            </Col>\n                                            <Col >\n                                                <Link to={`/product/${item.product}`}/>\n                                                {item.name}\n                                            </Col>\n                                            <Col md={4}>\n                                                {item.qty} x ${item.price} = ${(item.qty * item.price).toFixed(2)}\n                                            </Col> \n                                        </Row>\n                                    </ListGroup.Item>\n                                )})}\n                            </ListGroup>\n                        )}\n                    </ListGroup>   \n                </Col>\n\n                <Col md={4}>\n                    <Card>\n                        <ListGroup variant=\"flush\">\n                            <ListGroup.Item>\n                                <h2> Order Summary </h2>\n                            </ListGroup.Item>\n                            \n                            <ListGroup.Item>\n                                <Row>\n                                    <Col> Items </Col>\n                                    <Col> ${cart.itemsPrice}</Col>\n                                </Row>\n                            </ListGroup.Item>\n                          \n                            <ListGroup.Item>\n                                <Row>\n                                    <Col> 10% Shipping Fee (free for items over $1000) </Col>\n                                    <Col> ${cart.shippingPrice}</Col>\n                                </Row>\n                            </ListGroup.Item>\n\n                            <ListGroup.Item>\n                                <Row>\n                                    <Col> Tax </Col>\n                                    <Col> ${cart.taxPrice}</Col>\n                                </Row>\n                            </ListGroup.Item>\n\n                            <ListGroup.Item>\n                                <Row>\n                                    <Col> Total </Col>\n                                    <Col> ${cart.totalPrice}</Col>\n                                </Row>\n                            </ListGroup.Item>\n\n                            <ListGroup.Item>\n                                {error &&  <h1 variant=\"danger\">  {error}  </h1>}\n                            </ListGroup.Item>\n\n\n                            <ListGroup.Item>\n                                <Button type=\"button\" className=\"btn-block\" disabled={cart.cartItems===0} \n                                onClick={placeOrderHandler}> PlaceOrder </Button>\n                            </ListGroup.Item>\n\n                        </ListGroup>\n                    \n                    </Card>               \n                \n                </Col>\n\n\n            </Row>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}